//
//  textHelper.swift
//  PigulkaTime
//
//  Created by SHIN MIKHAIL on 07.11.2023.
//

/*
 
 - [ ] пофиксить редактируемые данные
 - [ ] Починить кор дата что б удалялось уведомление когда удаляю таблетку
 - [ ] Починить уведомления на завтрашний день

 

 
 Да, если вы хотите, чтобы изменения в Core Data были отражены в вашем основном контроллере после удаления данных из PillsViewController, вы можете использовать делегат (как вы уже сделали для добавления данных). Вот как вы можете это сделать:

 В вашем PillsViewController создайте протокол делегата для обновления данных в основном контроллере:
 swift
 Copy code
 protocol PillsViewControllerDelegate: AnyObject {
     func pillsViewController(_ controller: PillsViewController, didUpdatePills pills: [Pill])
 }
 В том же файле PillsViewController, добавьте свойство делегата:
 swift
 Copy code
 weak var delegate: PillsViewControllerDelegate?
 В методе удаления данных (в вашем методе deleteButtonTapped), вызовите делегата для уведомления основного контроллера о необходимости обновления данных:
 swift
 Copy code
 // В методе deleteButtonTapped
 // ...

 // Удалите данные из Core Data
 if let editingPill = self.editingPill {
     CoreDataManager.shared.deletePillFromCoreData(pill: editingPill)

     // Уведомите делегата об обновлении данных
     delegate?.pillsViewController(self, didUpdatePills: CoreDataManager.shared.loadPillsFromCoreData())
 }

 // Закройте PillsViewController
 self.dismiss(animated: true, completion: nil)
 В вашем основном контроллере реализуйте метод делегата для обновления данных:
 swift
 Copy code
 extension MainViewController: PillsViewControllerDelegate {
     func pillsViewController(_ controller: PillsViewController, didUpdatePills pills: [Pill]) {
         // Обновите данные в основном контроллере и перезагрузите таблицу
         self.pillsArray = pills
         self.tableView.reloadData()
     }
 }
 Установите основной контроллер в качестве делегата при открытии PillsViewController:
 swift
 Copy code
 // В методе didSelectRowAt
 let pillsViewController = PillsViewController()
 pillsViewController.delegate = self
 // Остальной код...
 Таким образом, при удалении данных из PillsViewController, делегат будет уведомлен, и основной контроллер обновит свои данные и перезагрузит таблицу.
 
 
 
 
 Усім привіт.
 Прошу більш досвідчених наштовхнути мене на правильний шлях.

 Отже, я створюю апку, яка нагадує про прийом ліків і створює повідомлення.

 Я додаю, наприклад, аспірин, приймання 3 рази, тобто я створюю аж 3 повідомлення.

 Потім я створюю ще один препарат з Н-назвою, і ось я не постійний такий вирішив, що видалю аспірин і як мені видалити його повідомлення?



 Я намагався створити сповіщення з ідентифікатором, начебто навіть принти виводжу про скасування сповіщень, а в підсумку сповіщення все одно з'являється.
 Чи правильно я взагалі мислю чи є спосіб простіший і робочий?

 Vladyslav, [20 Nov 2023, 13:08:34]:
 Як мені здається, то тобі треба зробити модельку зі сповіщенням де буде id конкретного сповіщення. В тебе, наприклад, є масив таких сповіщень і коли ти видаляєш з нього якесь конкретне сповіщення, то ти робиш для нього removePendingNotificationRequest (чи якось так) передаючи туди конкретний id. В такому випадку сповіщення буде і видаляться і відмінятись сама нотифікація.

 я зробив масив, де зберігаються id, видаляю їх, але повідомлення надходять. Спробую  модельку зробить
 
 
 Щоб прибиралось конкретне, то треба конкретний id передавати. Погугли working with local push notifications swift. Там дуже багато інфи по цьому.
 
 а что если я буду сохранять каждое уведомление в отдельный массив для таблетки. понял, таблетку создаю, уведомление помещается в массив который привязан к таблетке, удаляю таблетку очищаю массив. и создавая 3 таблетки имею три независимых массива
 
 Я добавляю, например, аспирин, прием 3 раза, то есть я создаю аж 3 сообщения.

  Потом я создаю еще один препарат с Н-названием, и вот я не постоянный такой решил, что удалю аспирин и как мне удалить его сообщение?



  Я пытался создать уведомление с идентификатором, вроде даже принты вывожу об отмене уведомлений, а в итоге уведомление все равно появляется.
  Правильно ли я вообще мыслю или есть способ проще и рабочий?

  Vladyslav, [20 Nov 2023, 13:08:34]:
  Как мне кажется, то тебе надо сделать модельку с уведомлением где будет id конкретного уведомления. У тебя, например, есть массив таких уведомлений и когда ты удаляешь из него какое-то конкретное уведомление, то ты делаешь для него removePendingNotificationRequest (или как-то так) передавая туда конкретный id. В таком случае уведомление будет и удалятся и отменяться сама нотификация.

  я сделал массив, где хранятся id, удаляю их, но уведомления приходят. Попробую модельку сделает
  
  
  Чтобы убиралось конкретное, то надо конкретный id передавать. Погугли working with local push notifications swift. Там очень много инфы по этому.
  
  а что если я буду сохранять каждое уведомление в отдельный массив для таблетки. понял, таблетку создаю, уведомление помещается в массив который привязан к таблетке, удаляю таблетку очищаю массив. и создавая 3 таблетки имею три независимых массива
 */
